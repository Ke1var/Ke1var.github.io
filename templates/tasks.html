{% extends 'base.html' %}

{% block title %}
–í—Å–µ –∑–∞–¥–∞—á–∏
{% endblock %}

{% block content %}
<br><h1>–í—Å–µ –∑–∞–¥–∞—á–∏</h1>

<ul class="nav nav-tabs">
    <li class="nav-item">
        <a class="nav-link {% if not active_tab or active_tab == 'all' %}active{% endif %}" 
           href="{{ url_for('tasks') }}">–í—Å–µ –∑–∞–¥–∞—á–∏</a>
    </li>
    <li class="nav-item">
        <a class="nav-link {% if active_tab == 'important' %}active{% endif %}" 
           href="{{ url_for('important_tasks') }}">–í–∞–∂–Ω—ã–µ</a>
    </li>
    <li class="nav-item">
        <a class="nav-link {% if active_tab == 'daily' %}active{% endif %}" 
           href="{{ url_for('daily_tasks') }}">–ü–æ–≤—Å–µ–¥–Ω–µ–≤–Ω—ã–µ</a>
    </li>
</ul>

<br>

{% for post in tasks %}
    <div class="col d-flex align-items-start pt-3 mt-3 
        {% if post.completed %}bg-success bg-opacity-10 border border-success rounded{% endif %}">
        <div class="icon-square text-body-emphasis bg-body-secondary d-inline-flex align-items-center justify-content-center fs-4 flex-shrink-0 me-3">
            <svg class="bi" width="1em" height="1em" aria-hidden="true"><use xlink:href="#tools"></use></svg>
        </div> 
        <div class="flex-grow-1">
            <h3 class="fs-2 text-body-emphasis {% if post.completed %}text-decoration-line-through text-muted{% endif %}">
                {{ post.title }}
                {% if post.task_type == 'important' %}
                    <span class="badge bg-danger">–í–∞–∂–Ω–∞—è</span>
                {% elif post.task_type == 'daily' %}
                    <span class="badge bg-secondary">–ü–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–∞—è</span>
                {% endif %}
            </h3>
            <p class="{% if post.completed %}text-muted{% endif %}">{{ post.text }}</p>
            
    {% if post.due_date %}
        <p class="text-muted small">
            <strong>–°—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:</strong> 
            {{ post.due_date.strftime('%d.%m.%Y %H:%M') }}
            
            {% if post.completed and post.completed_at %}
                {% if post.completed_at <= post.due_date %}
                    <span class="badge bg-success">–í—ã–ø–æ–ª–Ω–µ–Ω–æ –≤–æ–≤—Ä–µ–º—è</span>
                {% else %}
                    <span class="-badge bg-warning text-dark">–í—ã–ø–æ–ª–Ω–µ–Ω–æ –Ω–µ –≤–æ–≤—Ä–µ–º—è</span>
                {% endif %}
            {% elif not post.completed and post.due_date < now() %}
                <span class="badge bg-danger">–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ</span>
            {% elif not post.completed and post.due_date >= now() %}
                <span class="badge bg-info">–í –ø—Ä–æ—Ü–µ—Å—Å–µ</span>
            {% endif %}
        </p>
    {% endif %}
            
            <div class="btn-group">
                <a href="#" class="btn btn-primary">–ë–æ–ª—å—à–µ</a>
                
                {% if not post.completed %}
                    <a href="/complete/{{ post.id }}" class="btn btn-success">
                        ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ
                    </a>
                {% else %}
                    <a href="/uncomplete/{{ post.id }}" class="btn btn-warning">
                        ‚Ü©Ô∏è –í–µ—Ä–Ω—É—Ç—å
                    </a>
                {% endif %}
                
                <a href="/delete/{{ post.id }}" class="btn btn-danger">
                    üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
                </a>
            </div>
        </div>
    </div>
    {% else %}
    <div class="alert alert-info">
        {% if active_tab == 'important' %}
            –ù–µ—Ç –≤–∞–∂–Ω—ã—Ö –∑–∞–¥–∞—á
        {% elif active_tab == 'daily' %}
            –ù–µ—Ç –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω—ã—Ö –∑–∞–¥–∞—á
        {% else %}
            –ù–µ—Ç –∑–∞–¥–∞—á
        {% endif %}
    </div>
{% endfor %}

{% endblock %}